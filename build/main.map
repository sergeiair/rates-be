{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./config/index.js","webpack:///./db/helpers/responseWrapper.js","webpack:///./db/schemes/prediction.js","webpack:///./db/schemes/rates.js","webpack:///./db/schemes/session.js","webpack:///./db/schemes/user.js","webpack:///./guards/authMiddlware.js","webpack:///./logger/AppLogger.js","webpack:///./logger/index.js","webpack:///./mailer/mailer.js","webpack:///./main.js","webpack:///./middlewares.js","webpack:///./modules/analyze/_routes/index.js","webpack:///./modules/analyze/controller.js","webpack:///./modules/analyze/data.service.js","webpack:///./modules/analyze/index.js","webpack:///./modules/predictions-scheduler/_routes/index.js","webpack:///./modules/predictions-scheduler/controller.js","webpack:///./modules/predictions-scheduler/data.service.js","webpack:///./modules/predictions-scheduler/index.js","webpack:///./modules/predictions-scheduler/predictions-scheduler.service.js","webpack:///./modules/predictions/_routes/index.js","webpack:///./modules/predictions/controller.js","webpack:///./modules/predictions/data.service.js","webpack:///./modules/predictions/index.js","webpack:///./modules/rates-scheduler/_routes/index.js","webpack:///./modules/rates-scheduler/constants.js","webpack:///./modules/rates-scheduler/controller.js","webpack:///./modules/rates-scheduler/data.service.js","webpack:///./modules/rates-scheduler/index.js","webpack:///./modules/rates-scheduler/rates-scheduler.service.js","webpack:///./modules/rates/_routes/index.js","webpack:///./modules/rates/controller.js","webpack:///./modules/rates/data.service.js","webpack:///./modules/rates/index.js","webpack:///./modules/stats/_routes/index.js","webpack:///./modules/stats/controller.js","webpack:///./modules/stats/data.service.js","webpack:///./modules/stats/index.js","webpack:///./modules/users/_routes/index.js","webpack:///./modules/users/controller.js","webpack:///./modules/users/data.service.js","webpack:///./modules/users/index.js","webpack:///./modules/users/sessionController.js","webpack:///./routes.js","webpack:///./static/rates.js","webpack:///./tf/predictionTFService.js","webpack:///./utils/email.js","webpack:///./utils/hash.js","webpack:///./utils/network.js","webpack:///./utils/session.js","webpack:///external \"@koa/cors\"","webpack:///external \"@tensorflow/tfjs-node\"","webpack:///external \"axios\"","webpack:///external \"bcrypt\"","webpack:///external \"fs\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-mount\"","webpack:///external \"koa-session-auth\"","webpack:///external \"koa-static\"","webpack:///external \"koa-trie-router\"","webpack:///external \"md5\"","webpack:///external \"node-schedule\"","webpack:///external \"nodemailer\"","webpack:///external \"ramda\"","webpack:///external \"realm\"","webpack:///external \"uuid\""],"names":["app","name","version","server","port","static_dir","root","options","ResponseWrapper","data","value","isObject","_data","_code","error","err","_error","code","a","constructor","Object","PredictionSchema","primaryKey","properties","id","predRate","realRate","finalRate","pair","owner","time","verifyTime","forecast","volatility","RateSchema","EURUSD","EURPLN","EURCHF","EURGBP","USDNOK","GBPUSD","USDRUB","USDCHF","USDPLN","USDJPY","SessionSchema","expired","info","UserSchema","email","type","indexed","pw","restoreToken","default","active","controller","SessionController","UsersDataService","authMiddleware","ctx","next","session","isNew","status","storedSession","getSession","getUserEmailFromSession","Date","now","fs","require","AppLogger","is","stack","logFile","write","split","message","toString","String","e","console","createWriteStream","flags","process","stdout","nodemailer","Mailer","sendPwReset","to","html","emailTransporter","sendMail","from","subject","text","createTransport","host","service","secure","auth","user","pass","debug","logger","Koa","env","HOST","PORT","config","middlewares","listen","cors","mount","sessionConfig","useToken","useCookie","key","maxAge","autoCommit","overwrite","httpOnly","signed","rolling","renew","genid","warn","use","throw","body","emit","keys","bodyParser","serve","routes","on","Router","router","AnalyzeController","AnalyzeDataService","PredictionTFService","getCompletedPredictions","post","getAllCompletedPredictions","request","map","dissoc","middleware","_dataServiceInstance","_tfsInstance","dataService","tfsService","params","schema","deleteRealmIfMigrationNeeded","path","Realm","open","then","realm","objects","filtered","dateStart","dateEnd","sorted","catch","PredictionsSchedulerController","PredictionsSchedulerDataService","enable","getStatus","checkStatus","get","bindSchedulerService","PredictionsSchedulerService","start","startPendingItemsReview","fillPendingPredictions","bind","StaticRatesStore","ratesHaveValue","latestRates","rates","currentEpoch","pendingItems","forEach","item","replace","parseFloat","close","scheduler","currency","job","instance","scheduleJob","stop","cancelJob","PredictionsController","PredictionsDataService","create","storeSingle","clearAll","del","getAll","items","predictions","prepareTFS","prepareTFService","verifySingle","getPredRateByHistory","result","getComputedPrediction","getPreparedPredData","getVolatilityByPair","length","data4TF","pred","undefined","trainModel","getResult","preds","delete","uuidv1","UpdateMode","Never","Promise","resolve","prediction","objectForPrimaryKey","isUserValid","RatesSchedulerController","RatesSchedulerDataService","API_KEY","DATA_SOURCE_ENDPOINT","PAIRS","RatesSchedulerService","dataFetched","requestDataImidiate","isSaveAllowed","price","updateStaticStore","updateLocalLatest","isNewValue","getStorageRatesValues","reduce","acc","curr","toISOString","axios","requestPairs","join","requestData","isRequiredTimePassed","updatePrevRequestTime","log","toLocaleTimeString","endpoint","response","RatesController","RatesDataService","getHistory","limit","query","number","slice","set","getStats","StatsController","all","getUsersCount","getPredsCount","getHistoryCount","StatsDataService","ratesConfig","usersConfig","predsConfig","UsersController","register","resp","login","getUser","storeSession","hashedEmail","getClientIp","logout","destroySession","restore","initRestore","createPw","v","registerUser","ip","getRestoreToken","token","getRestoreHTML","getUserUnsafe","userConfig","bcrypt","md5","Modified","reject","emailToRestoreToken","userNotFound","isEmpty","ratesScheduler","predictionsScheduler","users","analyze","stats","_latestRates","prevSet","requiredMsGap","some","tf","sequential","configure","init","getPrediction","inputMax","inputMinVal","labelMinVal","labelMax","tidy","normalizedPredTnsr","tensor2d","normalizedPredVals","sub","div","predResult","model","predict","reshape","readablePred","mul","add","dataSync","getNormalizedValues","inputTnsr","max","min","labelTnsr","inputs","labels","initTensors","util","shuffle","initInputTnsr","initLabelsTnsr","tensor","layers","dense","units","inputShape","useBias","compile","loss","optimizer","destroy","dispose","epochs","batchSize","isRunning","fit","req","headers"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.js\");\n","'use strict';\n\nexport default {\n  app: {\n    name: 'Koa',\n    version: '1.0.0'\n  },\n  server: {\n    port: 3333\n  },\n  static_dir: {\n    root: './static',\n    options: {}\n  },\n}\n","\nexport class ResponseWrapper {\n    _data = null;\n    _error = null;\n    _code = null;\n\n    set data(value) {\n        if (this.isObject(value)) {\n            this._data = { ...value };\n        }\n\n        this._code = 200;\n    }\n\n    get data() {\n        return this._data;\n    }\n\n    set error(err) {\n        this._error = err;\n        this._code = 503;\n    }\n\n    get code() {\n        return this._code;\n    }\n\n    set code(code) {\n        this._code = code;\n    }\n\n    isObject(a) {\n        return (!!a) && (a.constructor === Object);\n    };\n}\n","\nexport const PredictionSchema = {\n    name: 'Prediction',\n    primaryKey: 'id',\n    properties: {\n        id: 'string',\n        predRate: 'double',\n        realRate: 'double',\n        finalRate: 'double',\n        pair:  'string',\n        owner:  'string',\n        time: 'int',\n        verifyTime: 'int',\n        forecast: 'int',\n        volatility: 'int'\n    }\n};\n","\nexport const RateSchema = {\n    name: 'Rate',\n    primaryKey: 'id',\n    properties: {\n        id: 'int',\n\n        EURUSD: 'double',\n        EURPLN: 'double',\n        EURCHF: 'double',\n        EURGBP: 'double',\n\n        USDNOK: 'double',\n        GBPUSD: 'double',\n        USDRUB: 'double',\n        USDCHF: 'double',\n        USDPLN: 'double',\n        USDJPY: 'double',\n\n        time: 'string',\n    }\n};\n","\nexport const SessionSchema = {\n    name: 'Session',\n    primaryKey: 'id',\n    properties: {\n        expired: 'int',\n        id: 'string',\n        info: 'string'\n    }\n};\n","\nexport const UserSchema = {\n    name: 'User',\n    primaryKey: 'email',\n    properties: {\n        id: 'int',\n        email: {type: 'string', indexed: true},\n        name: 'string',\n        pw: 'string',\n        restoreToken: {type: 'string', default: ''},\n        active: {type: 'bool', default: true}\n    }\n};\n","import UsersDataService from \"../modules/users/data.service\";\nimport SessionController from \"../modules/users/sessionController\";\nimport {getUserEmailFromSession} from \"../utils/session\";\nimport {getClientIp} from \"../utils/network\";\n\nconst controller = new SessionController(new UsersDataService());\n\nexport const authMiddleware = async (ctx, next) => {\n    if (ctx.session.isNew) {\n        ctx.data = null;\n        ctx.status = 401;\n    } else {\n        const storedSession = await controller.getSession(getUserEmailFromSession(ctx));\n\n        if (!storedSession || storedSession.expired <= Date.now()) {\n            ctx.data = null;\n            ctx.status = 401;\n        }\n    }\n\n    ctx.type = 'json';\n    await next()\n};\n","import {is} from \"ramda\";\n\n\nconst fs = require('fs');\n\nexport class AppLogger {\n\n    static logFile = fs.createWriteStream('./logger/files/log', { flags: 'a' });\n    static logStdout = process.stdout;\n\n    static error(error) {\n        try {\n            if (is(Object, error)) {\n                if (error.stack) {\n                    this.logFile.write(`${error.stack.split(')')[0]} \\n`);\n                } else if (!error.stack) {\n                    this.logFile.write(`${error.message} \\n`);\n                } else {\n                    this.logFile.write(`Unknown error ${error.toString()} \\n`);\n                }\n            } else if (is(String, error)) {\n                this.logFile.write(`${error} \\n`);\n            }\n        } catch (e) {\n            console.error(e.message);\n        }\n    }\n}\n","export * from './AppLogger';\n","\nconst nodemailer = require('nodemailer');\n\n\nexport class Mailer {\n    static emailTransporter = nodemailer.createTransport({\n        host: 'smtp.gmail.com',\n        port: 465,\n        service: 'gmail',\n        secure: false,\n        auth: {\n            user: 'ratespalmail@gmail.com',\n            pass: 'rer9Ohdgmail'\n        },\n        debug: false,\n        logger: true\n    });\n\n    static sendPwReset(to, html) {\n        return this.emailTransporter.sendMail({\n            from: '\"Rates pal\" <noreply@ratespal.com>',\n            to,\n            subject: \"Reset password\",\n            text: \"\",\n            html,\n        });\n    }\n}\n","import config from \"./config\";\nimport middlewares from \"./middlewares\";\n\nconst Koa = require('koa');\nconst app = new Koa();\nconst host = process.env.HOST || '127.0.0.1';\nconst port = process.env.PORT || config.server.port;\n\nmiddlewares(app);\n\napp.listen(port, host);\n","import serve from 'koa-static'\nimport bodyParser from 'koa-bodyparser'\nimport config from \"./config\";\nimport routes from \"./routes\";\nimport {AppLogger} from \"./logger/AppLogger\";\n\nconst cors = require('@koa/cors');\nconst mount = require('koa-mount');\nconst session = require('koa-session-auth');\n\nexport const sessionConfig = {\n    useToken: true, /** (boolean) use token-session or not (default true) */\n    useCookie: false, /** (boolean) use cookie-session or not (default true) */\n    key: 'GoAway', /** (string) cookie and token key (default is KoaToken) */\n    /** (number || 'session') maxAge in ms (default is 1 days) */\n    /** 'session' will result in a cookie that expires when session/browser is closed */\n    /** Warning: If a session cookie is stolen, this cookie will never expire */\n    maxAge: 86400000 * 7,\n    autoCommit: true, /** (boolean) automatically commit headers (default true) */\n    overwrite: true, /** (boolean) can overwrite or not (default true) */\n    httpOnly: true, /** (boolean) httpOnly or not (default true) */\n    signed: true, /** (boolean) signed or not (default true) */\n    rolling: false, /** (boolean) Force a session identifier cookie to be set on every response. The expiration is reset to the original maxAge, resetting the expiration countdown. (default is false) */\n    renew: false, /** (boolean) renew session when session is nearly expired, so we can always keep user logged in. (default is false)*/\n    genid: (ctx) => AppLogger.warn(ctx)\n};\n\nexport default (app) => {\n    app.use(async (ctx, next) => {\n        try {\n            await next();\n\n            if (ctx.status === 404) {\n                ctx.throw(404)\n            }\n\n            if (ctx.status === 401) {\n                ctx.throw(401)\n            }\n\n            if (ctx.status === 200) {\n                ctx.body = {\n                    status: 200,\n                    data: ctx.body\n                }\n            }\n\n        } catch (err) {\n            AppLogger.error(err);\n\n            ctx.status = err.status || 500;\n            ctx.type = 'json';\n            ctx.body = {\n                status: ctx.status,\n                message: err.message\n            };\n\n            ctx.app.emit('error', err, ctx);\n\n        }\n    });\n\n    app.use(cors());\n    app.keys = ['11223344qqwweerr'];\n    app.use(bodyParser());\n    app.use(serve(config.static_dir.root));\n    app.use(session(sessionConfig, app));\n    app.use(mount('/api', routes()));\n\n    app.on('error', (err) => {\n        AppLogger.error(err.message);\n    });\n\n\n\n\n}\n\n\n","'use strict';\n\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\nimport AnalyzeController from \"../controller\";\nimport AnalyzeDataService from \"../data.service\";\nimport {getUserEmailFromSession} from \"../../../utils/session\";\nimport {PredictionTFService} from \"../../../tf/predictionTFService\";\nimport {dissoc, map} from \"ramda\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new AnalyzeController(\n    new AnalyzeDataService(),\n    new PredictionTFService()\n);\n\nexport const getCompletedPredictions = () => {\n  router.post('/completed', authMiddleware, async (ctx, next) => {\n    try {\n      const data = await controller.getAllCompletedPredictions(\n          getUserEmailFromSession(ctx),\n          ctx.request.body\n      );\n\n      ctx.body = { message: 'Done', data: map(dissoc('owner'), data) };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\n","'use strict';\n\nexport default class AnalyzeController {\n\n    tfsService;\n    dataService;\n\n    constructor(_dataServiceInstance, _tfsInstance) {\n        this.dataService = _dataServiceInstance;\n        this.tfsService = _tfsInstance;\n    }\n\n    getAllCompletedPredictions(email, params) {\n        return this.dataService.getAllCompletedPredictions(email, params);\n    }\n\n\n\n\n}\n","import Realm from \"realm\";\nimport {PredictionSchema} from \"../../db/schemes/prediction\";\nimport {AppLogger} from \"../../logger\";\n\nexport default class AnalyzeDataService {\n\n    config = {\n        schema: [PredictionSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/predictions/01.realm',\n    };\n\n    getAllCompletedPredictions(email, params) {\n        return Realm.open(this.config)\n            .then(realm => {\n                return realm.objects('Prediction')\n                    .filtered(`owner = \"${email}\" AND finalRate != ${0} AND time >= ${\n                        params.dateStart} AND verifyTime <= ${params.dateEnd}`)\n                    .sorted('time', true);\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {getCompletedPredictions} from \"./_routes\";\n\nconst router = new Router();\n\nexport default () => {\n  router.post(getCompletedPredictions());\n\n  return router.middleware()\n}\n","'use strict';\n\nimport PredictionsSchedulerController from \"../controller\";\nimport PredictionsSchedulerDataService from \"../data.service\";\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new PredictionsSchedulerController(new PredictionsSchedulerDataService());\n\nexport const enable = () => {\n  router.post('/enable', authMiddleware, async (ctx, next) => {\n    try {\n      controller.enable();\n\n      ctx.body = { message: 'Done', status: await controller.getStatus() };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const checkStatus = () => {\n  router.get('/status', authMiddleware, async (ctx, next) => {\n    try {\n      const status = await controller.getStatus();\n\n      ctx.body = { message: 'Done', status: status };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n","'use strict';\n\nimport PredictionsSchedulerService from \"./predictions-scheduler.service\";\nimport {StaticRatesStore} from \"../../static/rates\";\n\nexport default class PredictionsSchedulerController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n        this.bindSchedulerService();\n        this.enable();\n    }\n\n    enable() {\n        PredictionsSchedulerService.start('USD');\n    }\n\n    getStatus() {\n        return PredictionsSchedulerService.status;\n    }\n\n    bindSchedulerService() {\n        PredictionsSchedulerService.startPendingItemsReview = this.fillPendingPredictions.bind(this);\n    }\n\n    fillPendingPredictions() {\n        if (StaticRatesStore.ratesHaveValue()) {\n            this.dataService.fillPendingPredictions(StaticRatesStore.latestRates);\n        }\n    }\n\n}\n","import Realm from \"realm\";\nimport {PredictionSchema} from \"../../db/schemes/prediction\";\nimport {AppLogger} from \"../../logger\";\n\nexport default class PredictionsSchedulerDataService {\n\n    config = {\n        schema: [PredictionSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/predictions/01.realm',\n    };\n\n    fillPendingPredictions(rates) {\n        return Realm.open(this.config)\n            .then(realm => {\n                const currentEpoch = Date.now();\n                const pendingItems = realm.objects('Prediction')\n                    .filtered(`finalRate = 0 AND time < ${currentEpoch}`) || [];\n\n\n                realm.write(() => {\n                    pendingItems.forEach((item) => {\n                        const pair = item.pair.replace('/', '');\n\n                        item.finalRate = parseFloat(rates[pair]);\n                        item.verifyTime = currentEpoch;\n                    });\n                });\n\n                realm.close();\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n\n\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {enable, checkStatus} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.post(enable());\n  router.get(checkStatus());\n\n  return router.middleware()\n}\n","\nconst scheduler = require('node-schedule');\n\nexport default class PredictionsSchedulerService {\n\n    static instance = scheduler;\n\n    static job = null;\n\n    static status = 0;\n\n    static start(currency) {\n        this.job = this.instance.scheduleJob('*/30 * * * * *', () =>\n            this.startPendingItemsReview(currency));\n        this.status = 1;\n    }\n\n    static stop() {\n        this.instance.cancelJob(this.job);\n        this.status = 0;\n    }\n\n    static startPendingItemsReview(currency) {}\n\n\n}\n","'use strict';\n\nimport PredictionsController from \"../controller\";\nimport PredictionsDataService from \"../data.service\";\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\nimport {getUserEmailFromSession} from \"../../../utils/session\";\nimport {dissoc, map} from \"ramda\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new PredictionsController(\n    new PredictionsDataService()\n);\n\nexport const create = () => {\n  router.post('/', authMiddleware, async (ctx, next) => {\n    try {\n      controller.storeSingle({\n        ...ctx.request.body,\n        owner: getUserEmailFromSession(ctx)\n      });\n\n      ctx.body = { message: 'Done!' };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\nexport const clearAll = () => {\n  router.del('/clear', authMiddleware, async (ctx, next) => {\n    try {\n      controller.clearAll(getUserEmailFromSession(ctx));\n\n      ctx.body = { message: 'Done!' };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\nexport const getAll = () => {\n  router.get('/', authMiddleware, async (ctx, next) => {\n    try {\n      const items = await controller.getAll(getUserEmailFromSession(ctx));\n\n      ctx.body = { message: 'Done fetch!', predictions: map(dissoc('owner'), items) };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const prepareTFS = () => {\n  router.post('/prepare-for-history', authMiddleware, async (ctx, next) => {\n    try {\n      const status = await controller.prepareTFService(\n          ctx.request.body,\n          getUserEmailFromSession(ctx)\n      );\n\n      ctx.body = { message: 'Done!', status };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const verifySingle = () => {\n  router.post('/verify', authMiddleware, async (ctx, next) => {\n    try {\n      const data = await controller.verifySingle(\n          ctx.request.body,\n          getUserEmailFromSession(ctx)\n      );\n\n      ctx.body = { message: 'Done!', data };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const getPredRateByHistory = () => {\n  router.post('/compute-current', authMiddleware, async (ctx, next) => {\n    try {\n      const result = await controller.getComputedPrediction(\n          ctx.request.body\n      );\n\n      ctx.body = { message: 'Done!', result };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n","'use strict';\n\nimport {PredictionTFService} from \"../../tf/predictionTFService\";\nimport {StaticRatesStore} from \"../../static/rates\";\n\nexport default class PredictionsController {\n\n    tfsService;\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n    }\n\n    getAll(email) {\n        return this.dataService.getAll(email);\n    }\n\n    clearAll(email) {\n        return this.dataService.clearAll(email);\n    }\n\n    storeSingle(data) {\n        this.dataService.storeSingle(this.getPreparedPredData(data));\n    }\n\n    verifySingle(data, email) {\n        return this.dataService.verifySingle(data.id, email, StaticRatesStore.latestRates);\n    }\n\n    getPreparedPredData(data) {\n        return {\n            ...data,\n            volatility: this.getVolatilityByPair(data.volatility, data.pair)\n        }\n    }\n\n    getVolatilityByPair(value, pair) {\n        if (!!value) {\n            return value;\n        } else {\n            switch (pair) {\n                case 'USD/CHF':\n                case 'EUR/CHF':\n                    return 1;\n                case 'GBP/USD':\n                case 'USD/EUR':\n                case 'USD/JPY':\n                case 'USD/PLN':\n                case 'EUR/PLN':\n                    return 2;\n                case 'USD/RUB':\n                    return 4;\n                default:\n                    return 3;\n            }\n        }\n    }\n\n    async prepareTFService(params, email) {\n        const predictions = await this.dataService.getAllCompletedPredictions(email, params.pair);\n\n        if (!!predictions && predictions.length) {\n            const data4TF = predictions.map((pred) => ({\n                predRate: pred.predRate,\n                realRate: pred.realRate,\n                finalRate: pred.finalRate,\n                forecast: pred.forecast,\n                volatility: pred.volatility\n            }));\n\n            this.tfsService = undefined;\n            this.tfsService = new PredictionTFService(data4TF);\n\n            return await this.tfsService.trainModel(500, 32);\n        } else {\n            return 'empty'\n        }\n    }\n\n    getComputedPrediction(params) {\n        return this.tfsService.getResult([\n            this.getVolatilityByPair(params.volatility, params.pair),\n            params.forecast,\n            params.realRate,\n            params.predRate\n        ], 500);\n    }\n}\n","import {PredictionSchema} from \"../../db/schemes/prediction\";\nimport Realm from \"realm\";\nimport {AppLogger} from \"../../logger\";\nimport {v1 as uuidv1} from 'uuid';\nimport {dissoc} from \"ramda\";\n\nexport default class PredictionsDataService {\n\n    config = {\n        schema: [PredictionSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/predictions/01.realm',\n    };\n\n    getAll(email) {\n        return Realm.open(this.config)\n            .then(realm => {\n                return realm.objects('Prediction')\n                    .filtered(`owner = \"${email}\"`)\n                    .sorted('time', true);\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    clearAll(email) {\n        return Realm.open(this.config)\n            .then(realm => {\n                const preds = realm.objects('Prediction')\n                    .filtered(`owner = \"${email}\"`);\n\n                realm.write(() => {\n                    realm.delete(preds);\n                });\n\n                realm.close();\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    storeSingle(data) {\n        Realm.open(this.config)\n            .then(realm => {\n\n                realm.write(() => {\n                    realm.create('Prediction', {\n                        ...data,\n                        finalRate: 0,\n                        verifyTime: 0,\n                        id: uuidv1()\n                    }, Realm.UpdateMode.Never);\n                });\n\n                realm.close();\n            }).catch((e) => AppLogger.error(e));\n    }\n\n    verifySingle(id, email, rates) {\n        return Realm.open(this.config)\n            .then(async realm => {\n                return await new Promise((resolve) => {\n                    const prediction = realm.objectForPrimaryKey('Prediction', id);\n                    const isUserValid = prediction.owner === email;\n\n                    if (!!prediction && isUserValid && !prediction.finalRate) {\n                        realm.write(() => {\n                            const pair = prediction.pair.replace('/', '');\n\n                            prediction.finalRate = parseFloat(rates[pair]);\n                            prediction.verifyTime = Date.now();\n\n                            resolve(dissoc('owner', prediction))\n                        });\n\n                        realm.close();\n                    } else {\n                        resolve(dissoc('owner', prediction))\n                    }\n                });\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    getAllCompletedPredictions(email, pair) {\n        return Realm.open(this.config)\n            .then(realm => {\n                return realm.objects('Prediction')\n                    .filtered(`owner = \"${email}\" AND finalRate != ${0} AND pair = \"${pair}\"`);\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {clearAll, create, getAll, getPredRateByHistory, prepareTFS, verifySingle} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.del(clearAll());\n  router.post(create());\n  router.post(getPredRateByHistory());\n  router.post(prepareTFS());\n  router.post(verifySingle());\n  router.get(getAll());\n\n  return router.middleware()\n}\n","'use strict';\n\nimport RatesSchedulerController from \"../controller\";\nimport RatesSchedulerDataService from \"../data.service\";\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new RatesSchedulerController(new RatesSchedulerDataService());\n\nexport const enable = () => {\n  router.post('/enable', authMiddleware, async (ctx, next) => {\n    try {\n      controller.enable();\n\n      ctx.body = { message: 'Done', status: await controller.getStatus() };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const checkStatus = () => {\n  router.get('/status', authMiddleware, async (ctx, next) => {\n    try {\n      const status = await controller.getStatus();\n\n      ctx.body = { message: 'Done', status: status };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n","\nconst API_KEY = 'WtgXjLLRpYZqNwOOXId0';\n\nexport const DATA_SOURCE_ENDPOINT = 'https://fxmarketapi.com/apilive?api_key=' + API_KEY;\n\nexport const PAIRS = [\n    'EUR/USD', 'EUR/PLN', 'EUR/CHF', 'EUR/GBP',\n    'USD/NOK', 'GBP/USD', 'USD/RUB', 'USD/CHF',\n    'USD/PLN', 'USD/JPY'\n];\n","'use strict';\n\nimport RatesSchedulerService from \"./rates-scheduler.service\";\nimport {StaticRatesStore} from \"../../static/rates\";\n\nexport default class RatesSchedulerController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n        this.bindSchedulerService();\n        this.enable()\n    }\n\n    bindSchedulerService() {\n        RatesSchedulerService.dataFetched = this.dataFetched.bind(this);\n    }\n\n    enable() {\n        RatesSchedulerService.start('USD');\n        RatesSchedulerService.requestDataImidiate('USD')\n    }\n\n    getStatus() {\n        return RatesSchedulerService.status;\n    }\n\n    dataFetched(currency, data) {\n        if (this.isSaveAllowed(currency, data.price || {})) {\n            this.dataService.storeSingle(data.price || {});\n        }\n\n        this.updateStaticStore(data.price || {});\n    }\n\n    updateStaticStore(rates) {\n        StaticRatesStore.updateLocalLatest(rates);\n    }\n\n    isSaveAllowed(rates) {\n        return StaticRatesStore.isNewValue(rates);\n    }\n\n}\n","import Realm from \"realm\";\nimport {RateSchema} from \"../../db/schemes/rates\";\nimport {AppLogger} from \"../../logger\";\n\nexport default class RatesSchedulerDataService {\n\n    config = {\n        schema: [RateSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/rates/01.realm',\n    };\n\n    getStorageRatesValues(rates) {\n        return Object.keys(rates).reduce((acc, curr) => {\n            if (!!rates[curr]) {\n                return  { ...acc, [curr]: parseFloat(rates[curr]) }\n            } else {\n                return acc;\n            }\n        }, {});\n    }\n\n    storeSingle(rates) {\n        Realm.open(this.config)\n            .then(realm => {\n                realm.write(() => {\n                    realm.create('Rate', {\n                        id: Date.now(),\n                        time: new Date().toISOString(),\n                        ...this.getStorageRatesValues(rates)\n                    }, Realm.UpdateMode.Never);\n                });\n\n                realm.close();\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {enable, checkStatus} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.post(enable());\n  router.get(checkStatus());\n\n  return router.middleware()\n}\n","import {DATA_SOURCE_ENDPOINT, PAIRS} from \"./constants\";\nimport {StaticRatesStore} from \"../../static/rates\";\n\nconst axios = require('axios').default;\nconst scheduler = require('node-schedule');\n\nexport default class RatesSchedulerService {\n\n    static endpoint = DATA_SOURCE_ENDPOINT;\n\n    static instance = scheduler;\n\n    static job = null;\n\n    static status = 0;\n\n    static get requestPairs() {\n        return PAIRS.map(pair => pair.replace('/', '')).join();\n    }\n\n    static start(currency) {\n        this.job = this.instance.scheduleJob('*/5 * * * *', () => this.requestData(currency));\n        this.status = 1;\n    }\n\n    static stop() {\n        this.instance.cancelJob(this.job);\n        this.status = 0;\n    }\n\n    static dataFetched(currency, data) {}\n\n    static requestData(currency) {\n        if (StaticRatesStore.isRequiredTimePassed()) {\n            StaticRatesStore.updatePrevRequestTime();\n            console.log(new Date().toLocaleTimeString());\n\n            axios.get(`${this.endpoint}&currency=${this.requestPairs}`)\n                .then(response => this.dataFetched(currency, response.data))\n                .catch(console.error);\n        }\n    }\n\n    static requestDataImidiate(currency) {\n        console.log(new Date().toLocaleTimeString());\n\n        axios.get(`${this.endpoint}&currency=${this.requestPairs}`)\n            .then(response => this.dataFetched(currency, response.data))\n            .catch(console.error);\n    }\n}\n","'use strict';\n\nimport RatesController from \"../controller\";\nimport RatesDataService from \"../data.service\";\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\nimport {AppLogger} from \"../../../logger\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new RatesController(new RatesDataService());\n\nexport const getHistory = () => {\n  router.get('/history', authMiddleware, async (ctx, next) => {\n    try {\n      const {limit} = ctx.request.query;\n      const rates = await controller.getHistory(limit);\n\n      ctx.body = { message: 'Done', rates };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\n","'use strict';\n\nexport default class RatesController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n    }\n\n    getHistory(number) {\n        return this.dataService.getHistory(number);\n    }\n\n}\n","import Realm from \"realm\";\nimport {RateSchema} from \"../../db/schemes/rates\";\nimport {AppLogger} from \"../../logger\";\n\nexport default class RatesDataService {\n\n    config = {\n        schema: [RateSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/rates/01.realm',\n    };\n\n    getHistory(number) {\n        return Realm.open(this.config)\n            .then(realm => {\n                return realm.objects('Rate')\n                    .sorted('id', true)\n                    .slice(0, number);\n            }).catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {getHistory, getRates} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.get(getHistory());\n\n  return router.middleware()\n}\n","'use strict';\n\nimport RatesController from \"../controller\";\nimport RatesDataService from \"../data.service\";\nimport {authMiddleware} from \"../../../guards/authMiddlware\";\nimport {AppLogger} from \"../../../logger\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new RatesController(new RatesDataService());\n\nconst middleware = async (ctx, next) => {\n  ctx.type = 'json';\n  ctx.set('Access-Control-Expose-Headers', 'GoAway');\n\n  await next()\n};\n\nexport const getStats = () => {\n  router.get('/whatsgoingon', middleware, async (ctx, next) => {\n    try {\n      const data = await controller.getStats();\n\n      ctx.body = { message: 'Done', data };\n    } catch (e) {\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\n","'use strict';\n\nexport default class StatsController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n    }\n\n    getStats() {\n        return Promise.all([\n            this.dataService.getUsersCount(),\n            this.dataService.getPredsCount(),\n            this.dataService.getHistoryCount()\n        ]);\n    }\n\n}\n","import Realm from \"realm\";\nimport {RateSchema} from \"../../db/schemes/rates\";\nimport {AppLogger} from \"../../logger\";\nimport {PredictionSchema} from \"../../db/schemes/prediction\";\nimport {UserSchema} from \"../../db/schemes/user\";\n\nexport default class StatsDataService {\n\n    ratesConfig = {\n        schema: [RateSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/rates/01.realm',\n    };\n\n    predsConfig = {\n        schema: [PredictionSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/predictions/01.realm',\n    };\n\n    usersConfig = {\n        schema: [UserSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/users/01.realm',\n    };\n\n    getHistoryCount() {\n        return Realm.open(this.ratesConfig)\n            .then(realm => {\n                return realm.objects('Rate').length;\n            }).catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    getUsersCount() {\n        return Realm.open(this.usersConfig)\n            .then(realm => {\n                return realm.objects('User').length;\n            }).catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    getPredsCount() {\n        return Realm.open(this.predsConfig)\n            .then(realm => {\n                return realm.objects('Prediction').length;\n            }).catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {getStats} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.get(getStats());\n\n  return router.middleware()\n}\n","'use strict';\n\nimport UsersController from \"../controller\";\nimport UsersDataService from \"../data.service\";\nimport {getClientIp} from \"../../../utils/network\";\nimport {getUserEmailFromSession} from \"../../../utils/session\";\nimport * as md5 from \"md5\";\nimport {Mailer} from \"../../../mailer/mailer\";\nimport {AppLogger} from \"../../../logger\";\n\nconst Router = require('koa-trie-router');\nconst router = new Router();\nconst controller = new UsersController(new UsersDataService());\n\nconst middleware = async (ctx, next) => {\n  ctx.type = 'json';\n  ctx.set('Access-Control-Expose-Headers', 'GoAway');\n\n  await next()\n};\n\nexport const register = () => {\n  router.post('/register', middleware, async (ctx, next) => {\n    try {\n      const resp = await controller.register(ctx.request.body);\n\n      ctx.status = resp.code;\n      ctx.body = { message: 'Done', resp };\n    } catch (e) {\n      ctx.status = 500;\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\nexport const login = () => {\n  router.post('/login', middleware, async (ctx, next) => {\n\n    try {\n      const user = await controller.getUser(ctx.request.body);\n\n      if (!!user.data) {\n        controller.storeSession(user.data.hashedEmail, getClientIp(ctx.request));\n\n        ctx.session.user = `${user.data.hashedEmail}$${Date.now()}`;\n        ctx.body = { message: 'Done', data: {\n          email: user.data.email,\n          name: user.data.name\n        }};\n      } else {\n        ctx.body = { message: 'Not found', data: {} };\n      }\n\n      ctx.status = user.code;\n    } catch (e) {\n      ctx.status = 500;\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n\n  return router.middleware();\n};\n\nexport const logout = () => {\n  router.post('/logout', middleware, async (ctx, next) => {\n\n    try {\n      controller.destroySession(getUserEmailFromSession(ctx));\n\n      ctx.status = 200;\n      ctx.body = { message: 'Done' };\n    } catch (e) {\n      ctx.status = 500;\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const restore = () => {\n  router.post('/restore', middleware, async (ctx, next) => {\n\n    try {\n      const params = await controller.initRestore(ctx.request.body.user);\n\n      ctx.status = params.code;\n      ctx.body = { message: 'Done' };\n    } catch (e) {\n      ctx.status = 500;\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\nexport const createPw = () => {\n  router.post('/create-pw', middleware, async (ctx, next) => {\n\n    try {\n      const params = await controller.createPw(ctx.request.body.pw, ctx.request.body.v);\n\n      ctx.status = params.code;\n      ctx.body = { message: 'Done', data: params };\n    } catch (e) {\n      ctx.status = 500;\n      ctx.body = { message: e.message };\n    }\n\n    await next();\n  });\n\n  return router.middleware();\n};\n\n\n","'use strict';\n\nimport {Mailer} from \"../../mailer/mailer\";\nimport {getRestoreHTML} from \"../../utils/email\";\n\nexport default class UsersController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n    }\n\n    register(data) {\n        return this.dataService.registerUser(data);\n    }\n\n    getUser(data) {\n        return this.dataService.getUser(data);\n    }\n\n    storeSession(email, ip) {\n        return this.dataService.storeSession(email, ip);\n    }\n\n    destroySession(email) {\n        return this.dataService.destroySession(email);\n    }\n\n    async initRestore(email) {\n        const params = await this.dataService.getRestoreToken(email);\n\n        if (params.data.token) {\n            Mailer.sendPwReset(email, getRestoreHTML(params.data.name, params.data.token))\n        }\n\n        return params;\n    }\n\n    createPw(pw, token) {\n        return this.dataService.createPw(pw, token);\n    }\n\n\n}\n","import Realm from \"realm\";\nimport * as bcrypt from \"bcrypt\";\nimport {AppLogger} from \"../../logger\";\nimport {UserSchema} from \"../../db/schemes/user\";\nimport {ResponseWrapper} from \"../../db/helpers/responseWrapper\";\nimport {SessionSchema} from \"../../db/schemes/session\";\nimport {sessionConfig} from \"../../middlewares\";\nimport * as md5 from \"md5\";\nimport {emailToRestoreToken} from \"../../utils/hash\";\n\nexport default class UsersDataService {\n\n    userConfig = {\n        schema: [UserSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/users/01.realm',\n    };\n\n    sessionConfig = {\n        schema: [SessionSchema],\n        deleteRealmIfMigrationNeeded: true,\n        path: './db/files/sessions/01.realm',\n    };\n\n    getUserUnsafe(email) {\n        return Realm.open(this.userConfig)\n            .then(realm => realm.objectForPrimaryKey('User', email))\n            .catch((e) => AppLogger.error(e));\n    }\n\n    getSession(email) {\n        return Realm.open(this.sessionConfig)\n            .then(realm => realm.objectForPrimaryKey('Session', email))\n            .catch((e) => AppLogger.error(e));\n    }\n\n    async getUser(data) {\n        const response = new ResponseWrapper();\n        const user = await this.getUserUnsafe(data.email);\n\n        if (!!user && bcrypt.compareSync(data.pw || '', user.pw || '')) {\n            response.data = {\n                hashedEmail: md5(user.email),\n                email: user.email,\n                name: user.name\n            };\n        } else {\n            response.error = 'Not found';\n            response.code = 404;\n        }\n\n        return response;\n    }\n\n    storeSession(email, ip) {\n        return Realm.open(this.sessionConfig)\n            .then(realm => {\n                realm.write(() => {\n                    realm.create('Session', {\n                        expired: Date.now() + sessionConfig.maxAge,\n                        id: email,\n                        info: ip\n                    }, Realm.UpdateMode.Modified);\n                });\n\n                realm.close();\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    destroySession(email) {\n        return Realm.open(this.sessionConfig)\n            .then(realm => {\n                const session = realm.objectForPrimaryKey('Session', email);\n\n                if (!!session) {\n                    realm.write(() => {\n                        realm.delete(session)\n                    });\n                }\n\n                realm.close();\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    async getRestoreToken(email) {\n        return new Promise(((resolve, reject) => {\n            Realm.open(this.userConfig)\n                .then(realm => {\n                    const response = new ResponseWrapper();\n                    const user = realm.objectForPrimaryKey('User', email);\n\n                    if (!!user && !user.restoreToken) {\n                        realm.write(() => {\n                            user.restoreToken = emailToRestoreToken(email);\n                            response.data = {\n                                token: user.restoreToken,\n                                name: user.name\n                            };\n\n                            resolve(response);\n                        });\n                    } else {\n                        response.data = {status: \"started\"};\n                        response.code = 208;\n                        resolve(response);\n                    }\n\n                    realm.close();\n                })\n                .catch((e) => {\n                    AppLogger.error(e);\n                    reject(e.message);\n                });\n        }));\n    }\n\n    registerUser(data) {\n        return Realm.open(this.userConfig)\n            .then(realm => {\n                const { email, pw, name } = data;\n                const response = new ResponseWrapper();\n                const userNotFound = realm.objects('User')\n                    .filtered(`email = \"${email}\"`).isEmpty();\n\n                if (userNotFound) {\n                    realm.write(() => {\n                        realm.create('User', {\n                            id: realm.objects('User').length + 1,\n                            pw: bcrypt.hashSync(pw, 10),\n                            name: name || email.split('@')[0],\n                            email: email\n                        }, Realm.UpdateMode.Never);\n\n                        response.data = { email };\n                    });\n                } else {\n                    response.error = 'User already exists';\n                    response.code = 200\n                }\n\n                realm.close();\n                return response;\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n    async createPw(pw, token) {\n        return Realm.open(this.userConfig)\n            .then(realm => {\n                const response = new ResponseWrapper();\n                const user = realm.objects('User')\n                    .filtered(`restoreToken = \"${token}\" LIMIT(1)`);\n\n                if (user[0]) {\n                    realm.write(() => {\n                        user[0].pw = bcrypt.hashSync(pw, 10);\n                        user[0].restoreToken = \"\";\n\n                        response.data = { status: 'Done' };\n                    });\n                } else {\n                    response.error = 'Failed';\n                }\n\n                realm.close();\n                return response;\n            })\n            .catch((e) => {\n                AppLogger.error(e)\n            });\n    }\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport {createPw, login, logout, register, restore} from './_routes';\n\nconst router = new Router();\n\nexport default () => {\n  router.post(register());\n  router.post(login());\n  router.post(logout());\n  router.post(restore());\n  router.post(createPw());\n\n  return router.middleware()\n}\n","'use strict';\n\nexport default class SessionController {\n\n    dataService;\n\n    constructor(_dataServiceInstance) {\n        this.dataService = _dataServiceInstance;\n    }\n\n    getSession(email) {\n        return this.dataService.getSession(email);\n    }\n\n\n}\n","'use strict';\n\nimport Router from 'koa-trie-router';\nimport mount from 'koa-mount';\n\nimport predictions from 'predictions';\nimport ratesScheduler from 'rates-scheduler';\nimport predictionsScheduler from 'predictions-scheduler';\nimport rates from 'rates';\nimport users from 'users';\nimport analyze from 'analyze';\nimport stats from 'stats';\n\nexport const router = new Router();\n\nexport default () => {\n    router.use(mount('/predictions', predictions()));\n    router.use(mount('/rates-scheduler', ratesScheduler()));\n    router.use(mount('/predictions-scheduler', predictionsScheduler()));\n    router.use(mount('/rates', rates()));\n    router.use(mount('/users', users()));\n    router.use(mount('/analyze', analyze()));\n    router.use(mount('/stats', stats()));\n\n    return router.middleware()\n}\n","\nimport {PAIRS} from \"../modules/rates-scheduler/constants\";\n\nexport class StaticRatesStore {\n\n    static prevSet = Date.now();\n\n    static requiredMsGap = 5 * 60 * 1000;\n\n    static _latestRates = {};\n\n    static get latestRates() {\n        if (!this._latestRates || !Object.keys(this._latestRates).length) {\n            this._latestRates = PAIRS.reduce((acc, curr) => ({ ...acc, [curr]: 0 }), {});\n        }\n\n        return this._latestRates;\n    }\n\n    static set latestRates(value) {\n        this._latestRates = value;\n    }\n\n    static updateLocalLatest(rates) {\n        this.latestRates = rates;\n    }\n\n    static ratesHaveValue() {\n        return !!this.latestRates && !!Object.keys(this.latestRates).length;\n    }\n\n    static isRequiredTimePassed() {\n        return Date.now() - this.prevSet > this.requiredMsGap;\n    }\n\n    static updatePrevRequestTime() {\n        this.prevSet = Date.now();\n    }\n\n    static isNewValue(rates) {\n        return Object.keys(rates || {})\n            .some((pair) => rates[pair] !== this.latestRates[pair]);\n    }\n\n}\n","import {AppLogger} from \"../logger\";\n\nconst tf = require('@tensorflow/tfjs-node');\n\nexport class PredictionTFService {\n\n    isRunning = false;\n\n    model = tf.sequential();\n\n    inputTnsr = null;\n    labelTnsr = null;\n\n    _data = [];\n\n    constructor(data) {\n        this.configure();\n        this.init(data);\n    }\n\n    getPrediction(params, inputMax, inputMinVal, labelMinVal, labelMax) {\n        return tf.tidy(() => {\n            const normalizedPredTnsr = tf.tensor2d(params, [1, params.length]);\n            const normalizedPredVals = normalizedPredTnsr.sub(inputMinVal).div(inputMax.sub(inputMinVal));\n            const predResult = this.model.predict(normalizedPredVals.reshape([1, params.length]));\n            const readablePred = predResult.mul(labelMax.sub(labelMinVal)).add(labelMinVal);\n\n            return readablePred.dataSync();\n        });\n    }\n\n    getNormalizedValues() {\n        return tf.tidy(() => {\n            const inputMax = this.inputTnsr.max();\n            const inputMinVal = this.inputTnsr.min();\n            const labelMax = this.labelTnsr.max();\n            const labelMinVal = this.labelTnsr.min();\n\n            return {\n                inputs: this.inputTnsr.sub(inputMinVal).div(inputMax.sub(inputMinVal)),\n                labels: this.labelTnsr.sub(labelMinVal).div(labelMax.sub(labelMinVal)),\n                inputMax,\n                inputMinVal,\n                labelMax,\n                labelMinVal,\n            }\n        });\n    }\n\n    init(items) {\n        this._data = items || [];\n\n        this.initTensors();\n    }\n\n    initTensors() {\n        tf.util.shuffle(this._data);\n        this.initInputTnsr();\n        this.initLabelsTnsr();\n    }\n\n    initInputTnsr() {\n        this.inputTnsr = tf.tensor(this._data.map((item) => ([\n            item.volatility, item.forecast, item.realRate, item.predRate\n        ])));\n    }\n\n    initLabelsTnsr() {\n        this.labelTnsr = tf.tensor2d(\n            this._data.map((item) => item.finalRate\n        ), [this._data.length, 1]);\n    }\n\n    configure() {\n        this.model.add(tf.layers.dense({ units: 1, inputShape: [4] }));\n        this.model.add(tf.layers.dense({ units: 1, useBias: true }));\n        this.model.compile({ loss: 'meanSquaredError', optimizer: 'sgd' });\n    }\n\n    destroy() {\n        this.model.dispose()\n    }\n\n    async getResult(params) {\n        const { inputMax, inputMinVal, labelMinVal, labelMax } = this.getNormalizedValues();\n\n        return this.getPrediction(params, inputMax, inputMinVal, labelMinVal, labelMax);\n    }\n\n    trainModel(epochs, batchSize) {\n        const { inputs, labels } = this.getNormalizedValues();\n\n        return new Promise((resolve, reject) => {\n            if (!this.isRunning) {\n                this.isRunning = true;\n                this.model.fit(inputs, labels, {\n                    batchSize,\n                    epochs\n                }).then(() => {\n                    this.isRunning = false;\n                    resolve('trainingDone');\n                });\n            }\n        });\n    }\n\n\n\n}\n","\n\nexport function getRestoreHTML(name, token) {\n    return `\n        Hi ${name}, <br>\n        Need to reset your password? Click on the link below to get you in.  <br>\n        <a href=\"http://localhost:4000/reset-password?v=${token}\">Create new password</a>\n    `;\n}\n","import * as bcrypt from \"bcrypt\";\n\nexport function emailToRestoreToken(email) {\n    return bcrypt.hashSync(email + \"_frvr3$R34gTgtr5_\", 5);\n}\n","export function getClientIp(req) {\n    return req.headers['referer'];\n}\n","\nexport function getUserEmailFromSession(ctx) {\n    return (ctx.session.user || '').split('$')[0];\n}\n","module.exports = require(\"@koa/cors\");","module.exports = require(\"@tensorflow/tfjs-node\");","module.exports = require(\"axios\");","module.exports = require(\"bcrypt\");","module.exports = require(\"fs\");","module.exports = require(\"koa\");","module.exports = require(\"koa-bodyparser\");","module.exports = require(\"koa-mount\");","module.exports = require(\"koa-session-auth\");","module.exports = require(\"koa-static\");","module.exports = require(\"koa-trie-router\");","module.exports = require(\"md5\");","module.exports = require(\"node-schedule\");","module.exports = require(\"nodemailer\");","module.exports = require(\"ramda\");","module.exports = require(\"realm\");","module.exports = require(\"uuid\");"],"sourceRoot":""}